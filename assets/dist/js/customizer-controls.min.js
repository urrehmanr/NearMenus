(r=>{wp.customize.bind("ready",function(){var n,e,t,i;function o(){i=0,wp.customize.section.each(function(e){var o=!1;e.controls().forEach(function(e){e.setting&&e.setting.get()!==e.setting._value&&(o=!0)}),o&&i++});var e=Math.round(i/t*100),o=r("#nearmenus-progress");o.length||(r("#customize-header-actions").prepend('<div id="nearmenus-progress" style="background: #ddd; height: 3px; margin-bottom: 10px; border-radius: 3px;"><div class="progress-fill" style="background: #0073aa; height: 100%; width: 0%; transition: width 0.3s; border-radius: 3px;"></div></div>'),o=r("#nearmenus-progress")),o.find(".progress-fill").css("width",e+"%")}["nearmenus_primary_color","nearmenus_secondary_color","nearmenus_success_color","nearmenus_warning_color","nearmenus_error_color"].forEach(function(e){var o,n,e=wp.customize.control(e);e&&(e={nearmenus_primary_color:["#3b82f6","#1d4ed8","#2563eb","#1e40af","#1e3a8a"],nearmenus_secondary_color:["#f97316","#ea580c","#dc2626","#b91c1c","#991b1b"],nearmenus_success_color:["#10b981","#059669","#047857","#065f46","#064e3b"],nearmenus_warning_color:["#f59e0b","#d97706","#b45309","#92400e","#78350f"],nearmenus_error_color:["#ef4444","#dc2626","#b91c1c","#991b1b","#7f1d1d"]}[(o=e).id])&&(n='<div class="customize-control-color-palette" style="margin-top: 10px;">',n+='<span style="font-size: 12px; color: #666; display: block; margin-bottom: 5px;">Quick colors:</span><div style="display: flex; gap: 5px; flex-wrap: wrap;">',e.forEach(function(e){n=(n+='<button type="button" class="palette-color" style="width: 30px; height: 30px; border: 2px solid #ddd; border-radius: 3px; ')+"background-color: "+e+'; cursor: pointer; padding: 0;" data-color="'+e+'" title="'+e+'"></button>'}),n+="</div></div>",o.container.find(".customize-control-content").append(n),o.container.find(".palette-color").on("click",function(){var e=r(this).data("color");o.setting.set(e)}))}),wp.customize("nearmenus_hero_cta_text",function(e){e.bind(function(e){var o=wp.customize.control("nearmenus_hero_cta_url");o&&(e?o.container.show():o.container.hide())})}),["facebook","twitter","instagram","youtube","linkedin","tiktok"].forEach(function(n){wp.customize("nearmenus_social_"+n,function(e){e.bind(function(e){var o=wp.customize.control("nearmenus_social_"+n);o&&(o=o.container.find("label"),e?o.find(".social-indicator").length||o.append(' <span class="social-indicator" style="color: green;">âœ“</span>'):o.find(".social-indicator").remove())})})}),n={nearmenus_colors:"These colors will be used throughout your theme. Changes are previewed in real-time.",nearmenus_hero:"Customize your homepage hero section to make a great first impression.",nearmenus_contact:"Contact information appears in your footer and can be used in schema markup.",nearmenus_social:"Add your social media profiles to increase engagement.",nearmenus_search:"Configure how restaurant listings are displayed and searched.",nearmenus_display:"Control the appearance and layout of your restaurant listings."},Object.keys(n).forEach(function(e){var o=wp.customize.section(e);o&&(e=n[e],o.container.find(".accordion-section-content").prepend('<div class="customize-section-description" style="padding: 15px; background: #f7f7f7; border: 1px solid #ddd; margin-bottom: 15px; border-radius: 3px; font-size: 14px; color: #666;">'+e+"</div>"))}),(e=wp.customize.section("nearmenus_colors"))&&(e.container.find(".accordion-section-content").append('<button type="button" id="reset-colors" class="button" style="margin: 10px 15px;">Reset to Default Colors</button>'),r("#reset-colors").on("click",function(){confirm("Are you sure you want to reset all colors to their defaults?")&&(wp.customize("nearmenus_primary_color").set("#3b82f6"),wp.customize("nearmenus_secondary_color").set("#f97316"),wp.customize("nearmenus_success_color").set("#10b981"),wp.customize("nearmenus_warning_color").set("#f59e0b"),wp.customize("nearmenus_error_color").set("#ef4444"))})),(e=wp.customize.section("nearmenus_social"))&&e.container.find(".accordion-section-content").append('<div style="padding: 10px 15px; background: #fff3cd; border: 1px solid #ffeaa7; margin: 10px 15px; border-radius: 3px; font-size: 12px;"><strong>Tip:</strong> Enter full URLs (including https://) for your social media profiles.</div>'),["facebook","twitter","instagram","youtube","linkedin","tiktok"].forEach(function(e){e=wp.customize.control("nearmenus_social_"+e);e&&e.container.find("input").on("blur",function(){var e=r(this).val(),o=!0;e&&!e.match(/^https?:\/\//)&&(o=!1),r(this).removeClass("invalid-input valid-input"),e&&r(this).addClass(o?"valid-input":"invalid-input")})}),(e=wp.customize.control("nearmenus_email"))&&e.container.find("input").on("blur",function(){var e=r(this).val(),o=!e||e.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);r(this).removeClass("invalid-input valid-input"),e&&r(this).addClass(o?"valid-input":"invalid-input")}),(e=wp.customize.control("nearmenus_phone"))&&e.container.find("input").on("blur",function(){var e=r(this).val(),o=!e||e.match(/^[\+]?[1-9][\d]{0,15}$/);r(this).removeClass("invalid-input valid-input"),e&&r(this).addClass(o?"valid-input":"invalid-input")}),r("head").append(`
                <style>
                .valid-input {
                    border-color: #10b981 !important;
                    box-shadow: 0 0 0 1px #10b981 !important;
                }
                .invalid-input {
                    border-color: #ef4444 !important;
                    box-shadow: 0 0 0 1px #ef4444 !important;
                }
                .palette-color:hover {
                    transform: scale(1.1);
                    border-color: #666 !important;
                }
                .palette-color:focus {
                    outline: 2px solid #0073aa;
                    outline-offset: 2px;
                }
                .customize-section-description p {
                    margin: 0;
                }
                </style>
            `),r(document).on("keydown",function(e){(e.ctrlKey||e.metaKey)&&83===e.which&&(e.preventDefault(),wp.customize.previewer.save()),27===e.which&&wp.customize.section.each(function(e){e.expanded()&&e.collapse()})}),t=Object.keys(wp.customize.section._value).length,i=0,wp.customize.bind("change",o),o(),localStorage.getItem("nearmenus_customizer_welcome")||setTimeout(function(){wp.customize.notifications.add("nearmenus_welcome",new wp.customize.Notification("nearmenus_welcome",{message:"Welcome to NearMenus theme customization! Use the sections below to customize your restaurant directory.",type:"info",dismissible:!0})),localStorage.setItem("nearmenus_customizer_welcome","shown")},1e3)})})(jQuery);